<!DOCTYPE html>
<html>
<body>
<p>This test passes if it doesn't crash.</p>
<script>
if (window.testRunner) {
    testRunner.dumpAsText();
    testRunner.waitUntilDone();
}

let workerBlob = `
async function runTest() {
    var fontFaceSet = await self.fonts.ready;
    fontFaceSet.onloadingdone = () => { };
    postMessage("ready");
}
runTest();
`;

function runTest() {
    let worker = new Worker(self.URL.createObjectURL(new Blob([workerBlob], { type: 'text/javascript' })));
    worker.onmessage = () => {
        worker.terminate();
        setTimeout(() => {
            if (window.testRunner)
                testRunner.notifyDone();
        }, 200);
    };
}
onload = runTest();
</script>
</body>
</html>
